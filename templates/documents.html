<script>
// ... Rest of the file remains same ...

// Add back the missing function
function loadCategoriesByDepartment(departmentId) {
    const categorySelect = document.getElementById('documentCategory');
    showLoading(categorySelect);
    
    fetch(`/api/categories/departments/${departmentId}/categories`)
        .then(response => response.json())
        .then(data => {
            categorySelect.innerHTML = '<option value="">Select Category</option>' +
                data.map(cat => `<option value="${cat.id}">${cat.name}</option>`).join('');
        })
        .catch(error => {
            console.error('Error loading categories:', error);
            showErrorMessage('Failed to load categories');
        })
        .finally(() => {
            hideLoading(categorySelect);
        });
}
</script>
